<div class="container mt-5">
  <div class="row">
    <div class="col-6 mx-auto">

      <% if @user.id == current_user.id %>
        <h2 class="text-center m-5 text-primary">マイページ</h2>
        <div class="text-center mb-5" >
          <%= link_to "編集する", edit_user_path(@user), class: "btn btn-outline-primary btn-lg" %>
        </div>      
      <% else %>
        <h2 class="text-center m-5 text-primary">@user.name ページ</h2>
      <% end %>

      <div>
        <h4 class="card-text">
          <small>ユーザー名</small> : <%= @user.name %>
        </h4>
        <h4 class="card-text">
          <small>学校</small> : <%= @user.school %>
        </h4>
        <h4 class="card-text">
          <small>学年</small> : <%= @user.grade %>
        </h4>          
        <h4 class="card-text">
          <small>学科</small> : <%= @user.department %>
        </h4>
        <h4 class="card-text">
          <small>性別</small> : <%= @user.gender %>
        </h4>
        <% if @user.id == current_user.id %>
          <h4 class="card-text">
            <small>メールアドレス</small> : <%= @user.email %>
          </h4>
        <% end %>
      </div>

      <h3 class="m-3">募集イベント(ホスト)</h3>
      <% @user.events.each do |event| %>

        <div class="card mb-4" style="min-width: 200px;">
          <div class="card-body">
            <h5 class="card-title"><small class="text-muted">ホスト</small><%=event.host.name %></h5>
            <p><%=event.setting_count %><small class="text-muted">人募集</small></p>
            <p class="card-text"><%=event.content %></p>
            <p class="card-title"><small class="text-muted">開催日</small> <%=event.event_date %></p>
            <%=link_to 'イベント詳細', event_path(event.id)%>
          </div>
          <div class="card-footer pt-0">
            <p><%=event.coupon.restaurant.name %></p>
            <p><%=event.coupon.min_setting_count %><small class="text-muted">人以上の来店で</small></p>
            <p><%=event.coupon.content %></p>
          </div>
          <%= link_to event_path(event), method: :delete, data: {confirm: "削除しますか？"} do %>
            このイベントを削除する
          <% end %>
        </div>

      <% end %>

      <h3 class="m-3">参加イベント(メンバー)</h3>
      <% @user.participate_events.each do |event| %>

        <div class="card mb-4" style="min-width: 200px;">
          <div class="card-body">
            <h5 class="card-title"><small class="text-muted">ホスト</small><%=event.host.name %></h5>
            <p><%=event.setting_count %><small class="text-muted">人募集</small></p>
            <p class="card-text"><%=event.content %></p>
            <p class="card-title"><small class="text-muted">開催日</small> <%=event.event_date %></p>
            <%=link_to 'イベント詳細', event_path(event.id)%>
          </div>
          <div class="card-footer pt-0">
            <p><%=event.coupon.restaurant.name %></p>
            <p><%=event.coupon.min_setting_count %><small class="text-muted">人以上の来店で</small></p>
            <p><%=event.coupon.content %></p>
          </div>
        </div>

      <% end %>

      <h3 class="m-3">チェッククーポン</h3>
      <% @user.checkd_coupons.each do |coupon| %>
       <div class="card mb-4" style="min-width: 200px;">
          <div class="card-body">
              <h5 class="card-title"><small class="text-muted">店舗名</small><br><%=coupon.restaurant.name %></h5>
              <p><%=coupon.min_setting_count %><small class="text-muted">人以上で</small></p>
              <p class="card-text"><%=coupon.content %></p>
              <%=link_to 'クーポン詳細', coupon_path(coupon.id) %>
          </div>
          <div class="card px-3 py-2 mb-3">
              <small class="text-muted">有効期限</small>
              <% if coupon.exp_date %>
                  <%=coupon.exp_date %>
              <% else %>
                  無期限 
              <% end %>
          </div>
          <div class="mx-auto mb-3">
              <%= button_to "イベントを投稿する", new_event_path, { method: :get, params: {coupon_id: coupon.id} } %>
          </div>
       </div>
      <% end %>

    </div>
  </div>
</div>